<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<div class="bg-full">
  <div class="container">
    <div class="row justify-content-between">
      <div class="col-6 align-items-center">
        <h2>Active Boba Runs</h2>


        <% if (Run.where(status: 1).count > 0) %>
        <% Run.where(status: 1).limit(4).each do |run| %>
        <div class="card btn" type="button" style="width: 20rem;" data-toggle="modal" data-target="#exampleModal">
          <div class="card-body container">
            <div class="row  ">
              <div class="col-4 no-gutters align-items-center">
                <%if File.exist?("./public/uploads/users/#{@run.runner_id}/user_avatar.png") %>
                <img class="img-thumbnail"  src="../uploads/users/<%= run.runner_id %>/user_avatar.png">
                <%else %>
                <img class="img-thumbnail" src="/img/avatar_placeholder.png">
                <%end %>
              </div>
              <div class="col-7">
                <div class="row">
                  <div class="col-6">
                    <div class="row">
                      <h5 class="card_title">run.bussiness_id</h5>
                    </div>
                    <div class="row mt-1">
                      <i class="fa fa-star checked"></i><i class="fa fa-star checked"></i><i
                      class="fa fa-star checked"></i><i class="fa fa-star checked"></i><i
                      class="fa fa-star checked"></i>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="row ml-1">
                      <h5 class="mb-3 ml-5"><%= Order.where(run_id: run.id).count.to_s + '/' + run.order_cap.to_s %></h5>
                    </div>
                    <div class="row ml-5 ">
                      <h6 class="card-subutitle mb-1 text-muted "><%= '%02d' % ((run.datetime - Time.now)/60/60) %></h6>
                    </div>

                    <div class="row">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>


        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">"Name" is offering "X" on "Y"</h5> <!--TODO-->
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                  Button
                </button>
                <div class="collapse" id="collapseExample">
                  <div class="card card-body">
                    ...
                    <button type="button" class="btn btn-primary">Submit Order</button>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>

        <% end %>
        <% else %>
        <h4>No Active Runs</h4>
        <% end %>


        <p></p>
        <div class="container">
          <a href="/runs/new">
            <button type="button" class="btn btn-primary">Submit Run</button>
          </a>
        </div>
      </div>
      <div class="col-6">
        <h2>My Current Active Orders</h2>
        <% Order.where(status: 1).limit(6).each do |order| %>
        <div class="card btn" type="button" style="width: 20rem;" data-toggle="modal" data-target="#"+order.id>
          <div class="card-body container">
            <div class="row align-items-center">
              <div class="col-4 no-gutters align-items-center">
                <img src=User.where(id: Run.where(id: order.run_id).runner_id).filename alt="..." class="img-thumbnail">
              </div>
              <div class="col-7">
                <div class="row">
                  <h5 class="card_title text-center"><%= get_business_name Run.where(id: order.run_id).business_id %></h5>
                  <div class="row">
                    <div class="col-5">
                      <p class="card-text">Run.where(id: order.run_id).bussiness_id</p>
                    </div>
                    <div class="col-5">
                      <p class="card-text">order.cost</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="modal fade" id="orderID" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><%= get_business_name Run.where(id: order.run_id).business_id + "delivery" %></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-4">
                    order.order_desc
                  </div>
                  <div class="col-4">
                    order.cost
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
